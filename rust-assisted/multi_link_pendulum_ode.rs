use ndarray::*;
use ndarray_linalg::*;

const DOF:usize = 16;

fn M_flat(q: [f64; 16]) ->  [f64; 256] {
    let q_0 = q[0]; let q_0s = q_0.sin(); let q_0c = q_0.cos(); 
    let q_1 = q[1]; let q_1s = q_1.sin(); let q_1c = q_1.cos(); 
    let q_2 = q[2]; let q_2s = q_2.sin(); let q_2c = q_2.cos(); 
    let q_3 = q[3]; let q_3s = q_3.sin(); let q_3c = q_3.cos(); 
    let q_4 = q[4]; let q_4s = q_4.sin(); let q_4c = q_4.cos(); 
    let q_5 = q[5]; let q_5s = q_5.sin(); let q_5c = q_5.cos(); 
    let q_6 = q[6]; let q_6s = q_6.sin(); let q_6c = q_6.cos(); 
    let q_7 = q[7]; let q_7s = q_7.sin(); let q_7c = q_7.cos(); 
    let q_8 = q[8]; let q_8s = q_8.sin(); let q_8c = q_8.cos(); 
    let q_9 = q[9]; let q_9s = q_9.sin(); let q_9c = q_9.cos(); 
    let q_10 = q[10]; let q_10s = q_10.sin(); let q_10c = q_10.cos(); 
    let q_11 = q[11]; let q_11s = q_11.sin(); let q_11c = q_11.cos(); 
    let q_12 = q[12]; let q_12s = q_12.sin(); let q_12c = q_12.cos(); 
    let q_13 = q[13]; let q_13s = q_13.sin(); let q_13c = q_13.cos(); 
    let q_14 = q[14]; let q_14s = q_14.sin(); let q_14c = q_14.cos(); 
    let q_15 = q[15]; let q_15s = q_15.sin(); let q_15c = q_15.cos(); 
    let out1 = [2.8125*q_0s.powi(2) + 2.8125*q_0c.powi(2), 2.57658333333333*q_0s*q_1s + 2.57658333333333*q_0c*q_1c, 2.296*q_0s*q_2s + 2.296*q_0c*q_2c, 2.03275*q_0s*q_3s + 2.03275*q_0c*q_3c, 1.78633333333333*q_0s*q_4s + 1.78633333333333*q_0c*q_4c, 1.55625*q_0s*q_5s + 1.55625*q_0c*q_5c, 1.342*q_0s*q_6s + 1.342*q_0c*q_6c, 1.14308333333333*q_0s*q_7s + 1.14308333333333*q_0c*q_7c, 0.959*q_0s*q_8s + 0.959*q_0c*q_8c, 0.78925*q_0s*q_9s + 0.78925*q_0c*q_9c, 0.633333333333333*q_0s*q_10s + 0.633333333333333*q_0c*q_10c, 0.49075*q_0s*q_1s + 0.49075*q_0c*q_1c, 0.361*q_0s*q_12s + 0.361*q_0c*q_12c, 0.243583333333333*q_0s*q_13s + 0.243583333333333*q_0c*q_13c, 0.138*q_0s*q_14s + 0.138*q_0c*q_14c, 0.04375*q_0s*q_15s + 0.04375*q_0c*q_15c, 2.57658333333333*q_0s*q_1s + 2.57658333333333*q_0c*q_1c, 2.4670275*q_1s.powi(2) + 2.4670275*q_1c.powi(2), 2.25008*q_1s*q_2s + 2.25008*q_1c*q_2c, 1.992095*q_1s*q_3s + 1.992095*q_1c*q_3c, 1.75060666666667*q_1s*q_4s + 1.75060666666667*q_1c*q_4c, 1.525125*q_1s*q_5s + 1.525125*q_1c*q_5c, 1.31516*q_1s*q_6s + 1.31516*q_1c*q_6c, 1.12022166666667*q_1s*q_7s + 1.12022166666667*q_1c*q_7c, 0.93982*q_1s*q_8s + 0.93982*q_1c*q_8c, 0.773465*q_1s*q_9s + 0.773465*q_1c*q_9c, 0.620666666666667*q_1s*q_10s + 0.620666666666667*q_1c*q_10c, 0.480935*q_1s.powi(2) + 0.480935*q_1c.powi(2), 0.35378*q_1s*q_12s + 0.35378*q_1c*q_12c, 0.238711666666667*q_1s*q_13s + 0.238711666666667*q_1c*q_13c, 0.13524*q_1s*q_14s + 0.13524*q_1c*q_14c, 0.042875*q_1s*q_15s + 0.042875*q_1c*q_15c, 2.296*q_0s*q_2s + 2.296*q_0c*q_2c, 2.25008*q_1s*q_2s + 2.25008*q_1c*q_2c, 2.1504*q_2s.powi(2) + 2.1504*q_2c.powi(2), 1.95144*q_2s*q_3s + 1.95144*q_2c*q_3c, 1.71488*q_2s*q_4s + 1.71488*q_2c*q_4c, 1.494*q_2s*q_5s + 1.494*q_2c*q_5c, 1.28832*q_2s*q_6s + 1.28832*q_2c*q_6c, 1.09736*q_2s*q_7s + 1.09736*q_2c*q_7c, 0.92064*q_2s*q_8s + 0.92064*q_2c*q_8c, 0.75768*q_2s*q_9s + 0.75768*q_2c*q_9c, 0.608*q_10s*q_2s + 0.608*q_10c*q_2c, 0.47112*q_1s*q_2s + 0.47112*q_1c*q_2c, 0.34656*q_12s*q_2s + 0.34656*q_12c*q_2c, 0.23384*q_13s*q_2s + 0.23384*q_13c*q_2c, 0.13248*q_14s*q_2s + 0.13248*q_14c*q_2c, 0.042*q_15s*q_2s + 0.042*q_15c*q_2c, 2.03275*q_0s*q_3s + 2.03275*q_0c*q_3c, 1.992095*q_1s*q_3s + 1.992095*q_1c*q_3c, 1.95144*q_2s*q_3s + 1.95144*q_2c*q_3c, 1.8610825*q_3s.powi(2) + 1.8610825*q_3c.powi(2), 1.67915333333333*q_3s*q_4s + 1.67915333333333*q_3c*q_4c, 1.462875*q_3s*q_5s + 1.462875*q_3c*q_5c, 1.26148*q_3s*q_6s + 1.26148*q_3c*q_6c, 1.07449833333333*q_3s*q_7s + 1.07449833333333*q_3c*q_7c, 0.90146*q_3s*q_8s + 0.90146*q_3c*q_8c, 0.741895*q_3s*q_9s + 0.741895*q_3c*q_9c, 0.595333333333333*q_10s*q_3s + 0.595333333333333*q_10c*q_3c, 0.461305*q_1s*q_3s + 0.461305*q_1c*q_3c, 0.33934*q_12s*q_3s + 0.33934*q_12c*q_3c, 0.228968333333333*q_13s*q_3s + 0.228968333333333*q_13c*q_3c, 0.12972*q_14s*q_3s + 0.12972*q_14c*q_3c, 0.041125*q_15s*q_3s + 0.041125*q_15c*q_3c, 1.78633333333333*q_0s*q_4s + 1.78633333333333*q_0c*q_4c, 1.75060666666667*q_1s*q_4s + 1.75060666666667*q_1c*q_4c, 1.71488*q_2s*q_4s + 1.71488*q_2c*q_4c, 1.67915333333333*q_3s*q_4s + 1.67915333333333*q_3c*q_4c, 1.59758*q_4s.powi(2) + 1.59758*q_4c.powi(2), 1.43175*q_4s*q_5s + 1.43175*q_4c*q_5c, 1.23464*q_4s*q_6s + 1.23464*q_4c*q_6c, 1.05163666666667*q_4s*q_7s + 1.05163666666667*q_4c*q_7c, 0.88228*q_4s*q_8s + 0.88228*q_4c*q_8c, 0.72611*q_4s*q_9s + 0.72611*q_4c*q_9c, 0.582666666666667*q_10s*q_4s + 0.582666666666667*q_10c*q_4c, 0.45149*q_1s*q_4s + 0.45149*q_1c*q_4c, 0.33212*q_12s*q_4s + 0.33212*q_12c*q_4c, 0.224096666666667*q_13s*q_4s + 0.224096666666667*q_13c*q_4c, 0.12696*q_14s*q_4s + 0.12696*q_14c*q_4c, 0.04025*q_15s*q_4s + 0.04025*q_15c*q_4c, 1.55625*q_0s*q_5s + 1.55625*q_0c*q_5c, 1.525125*q_1s*q_5s + 1.525125*q_1c*q_5c, 1.494*q_2s*q_5s + 1.494*q_2c*q_5c, 1.462875*q_3s*q_5s + 1.462875*q_3c*q_5c, 1.43175*q_4s*q_5s + 1.43175*q_4c*q_5c, 1.3584375*q_5s.powi(2) + 1.3584375*q_5c.powi(2), 1.2078*q_5s*q_6s + 1.2078*q_5c*q_6c, 1.028775*q_5s*q_7s + 1.028775*q_5c*q_7c, 0.8631*q_5s*q_8s + 0.8631*q_5c*q_8c, 0.710325*q_5s*q_9s + 0.710325*q_5c*q_9c, 0.57*q_10s*q_5s + 0.57*q_10c*q_5c, 0.441675*q_1s*q_5s + 0.441675*q_1c*q_5c, 0.3249*q_12s*q_5s + 0.3249*q_12c*q_5c, 0.219225*q_13s*q_5s + 0.219225*q_13c*q_5c, 0.1242*q_14s*q_5s + 0.1242*q_14c*q_5c, 0.039375*q_15s*q_5s + 0.039375*q_15c*q_5c, 1.342*q_0s*q_6s + 1.342*q_0c*q_6c, 1.31516*q_1s*q_6s + 1.31516*q_1c*q_6c, 1.28832*q_2s*q_6s + 1.28832*q_2c*q_6c, 1.26148*q_3s*q_6s + 1.26148*q_3c*q_6c, 1.23464*q_4s*q_6s + 1.23464*q_4c*q_6c, 1.2078*q_5s*q_6s + 1.2078*q_5c*q_6c, 1.14224*q_6s.powi(2) + 1.14224*q_6c.powi(2), 1.00591333333333*q_6s*q_7s + 1.00591333333333*q_6c*q_7c, 0.84392*q_6s*q_8s + 0.84392*q_6c*q_8c, 0.69454*q_6s*q_9s + 0.69454*q_6c*q_9c, 0.557333333333333*q_10s*q_6s + 0.557333333333333*q_10c*q_6c, 0.43186*q_1s*q_6s + 0.43186*q_1c*q_6c, 0.31768*q_12s*q_6s + 0.31768*q_12c*q_6c, 0.214353333333333*q_13s*q_6s + 0.214353333333333*q_13c*q_6c, 0.12144*q_14s*q_6s + 0.12144*q_14c*q_6c, 0.0385*q_15s*q_6s + 0.0385*q_15c*q_6c, 1.14308333333333*q_0s*q_7s + 1.14308333333333*q_0c*q_7c, 1.12022166666667*q_1s*q_7s + 1.12022166666667*q_1c*q_7c, 1.09736*q_2s*q_7s + 1.09736*q_2c*q_7c, 1.07449833333333*q_3s*q_7s + 1.07449833333333*q_3c*q_7c, 1.05163666666667*q_4s*q_7s + 1.05163666666667*q_4c*q_7c, 1.028775*q_5s*q_7s + 1.028775*q_5c*q_7c, 1.00591333333333*q_6s*q_7s + 1.00591333333333*q_6c*q_7c, 0.9476125*q_7s.powi(2) + 0.9476125*q_7c.powi(2), 0.82474*q_7s*q_8s + 0.82474*q_7c*q_8c, 0.678755*q_7s*q_9s + 0.678755*q_7c*q_9c, 0.544666666666667*q_10s*q_7s + 0.544666666666667*q_10c*q_7c, 0.422045*q_1s*q_7s + 0.422045*q_1c*q_7c, 0.31046*q_12s*q_7s + 0.31046*q_12c*q_7c, 0.209481666666667*q_13s*q_7s + 0.209481666666667*q_13c*q_7c, 0.11868*q_14s*q_7s + 0.11868*q_14c*q_7c, 0.037625*q_15s*q_7s + 0.037625*q_15c*q_7c, 0.959*q_0s*q_8s + 0.959*q_0c*q_8c, 0.93982*q_1s*q_8s + 0.93982*q_1c*q_8c, 0.92064*q_2s*q_8s + 0.92064*q_2c*q_8c, 0.90146*q_3s*q_8s + 0.90146*q_3c*q_8c, 0.88228*q_4s*q_8s + 0.88228*q_4c*q_8c, 0.8631*q_5s*q_8s + 0.8631*q_5c*q_8c, 0.84392*q_6s*q_8s + 0.84392*q_6c*q_8c, 0.82474*q_7s*q_8s + 0.82474*q_7c*q_8c, 0.77322*q_8s.powi(2) + 0.77322*q_8c.powi(2), 0.66297*q_8s*q_9s + 0.66297*q_8c*q_9c, 0.532*q_10s*q_8s + 0.532*q_10c*q_8c, 0.41223*q_1s*q_8s + 0.41223*q_1c*q_8c, 0.30324*q_12s*q_8s + 0.30324*q_12c*q_8c, 0.20461*q_13s*q_8s + 0.20461*q_13c*q_8c, 0.11592*q_14s*q_8s + 0.11592*q_14c*q_8c, 0.03675*q_15s*q_8s + 0.03675*q_15c*q_8c, 0.78925*q_0s*q_9s + 0.78925*q_0c*q_9c, 0.773465*q_1s*q_9s + 0.773465*q_1c*q_9c, 0.75768*q_2s*q_9s + 0.75768*q_2c*q_9c, 0.741895*q_3s*q_9s + 0.741895*q_3c*q_9c, 0.72611*q_4s*q_9s + 0.72611*q_4c*q_9c, 0.710325*q_5s*q_9s + 0.710325*q_5c*q_9c, 0.69454*q_6s*q_9s + 0.69454*q_6c*q_9c, 0.678755*q_7s*q_9s + 0.678755*q_7c*q_9c, 0.66297*q_8s*q_9s + 0.66297*q_8c*q_9c, 0.6177675*q_9s.powi(2) + 0.6177675*q_9c.powi(2), 0.519333333333333*q_10s*q_9s + 0.519333333333333*q_10c*q_9c, 0.402415*q_1s*q_9s + 0.402415*q_1c*q_9c, 0.29602*q_12s*q_9s + 0.29602*q_12c*q_9c, 0.199738333333333*q_13s*q_9s + 0.199738333333333*q_13c*q_9c, 0.11316*q_14s*q_9s + 0.11316*q_14c*q_9c, 0.035875*q_15s*q_9s + 0.035875*q_15c*q_9c, 0.633333333333333*q_0s*q_10s + 0.633333333333333*q_0c*q_10c, 0.620666666666667*q_1s*q_10s + 0.620666666666667*q_1c*q_10c, 0.608*q_10s*q_2s + 0.608*q_10c*q_2c, 0.595333333333333*q_10s*q_3s + 0.595333333333333*q_10c*q_3c, 0.582666666666667*q_10s*q_4s + 0.582666666666667*q_10c*q_4c, 0.57*q_10s*q_5s + 0.57*q_10c*q_5c, 0.557333333333333*q_10s*q_6s + 0.557333333333333*q_10c*q_6c, 0.544666666666667*q_10s*q_7s + 0.544666666666667*q_10c*q_7c, 0.532*q_10s*q_8s + 0.532*q_10c*q_8c, 0.519333333333333*q_10s*q_9s + 0.519333333333333*q_10c*q_9c, 0.48*q_10s.powi(2) + 0.48*q_10c.powi(2), 0.3926*q_1s*q_10s + 0.3926*q_1c*q_10c, 0.2888*q_10s*q_12s + 0.2888*q_10c*q_12c, 0.194866666666667*q_10s*q_13s + 0.194866666666667*q_10c*q_13c, 0.1104*q_10s*q_14s + 0.1104*q_10c*q_14c, 0.035*q_10s*q_15s + 0.035*q_10c*q_15c, 0.49075*q_0s*q_1s + 0.49075*q_0c*q_1c, 0.480935*q_1s.powi(2) + 0.480935*q_1c.powi(2), 0.47112*q_1s*q_2s + 0.47112*q_1c*q_2c, 0.461305*q_1s*q_3s + 0.461305*q_1c*q_3c, 0.45149*q_1s*q_4s + 0.45149*q_1c*q_4c, 0.441675*q_1s*q_5s + 0.441675*q_1c*q_5c, 0.43186*q_1s*q_6s + 0.43186*q_1c*q_6c, 0.422045*q_1s*q_7s + 0.422045*q_1c*q_7c, 0.41223*q_1s*q_8s + 0.41223*q_1c*q_8c, 0.402415*q_1s*q_9s + 0.402415*q_1c*q_9c, 0.3926*q_1s*q_10s + 0.3926*q_1c*q_10c, 0.3587025*q_1s.powi(2) + 0.3587025*q_1c.powi(2), 0.28158*q_1s*q_12s + 0.28158*q_1c*q_12c, 0.189995*q_1s*q_13s + 0.189995*q_1c*q_13c, 0.10764*q_1s*q_14s + 0.10764*q_1c*q_14c, 0.034125*q_1s*q_15s + 0.034125*q_1c*q_15c, 0.361*q_0s*q_12s + 0.361*q_0c*q_12c, 0.35378*q_1s*q_12s + 0.35378*q_1c*q_12c, 0.34656*q_12s*q_2s + 0.34656*q_12c*q_2c, 0.33934*q_12s*q_3s + 0.33934*q_12c*q_3c, 0.33212*q_12s*q_4s + 0.33212*q_12c*q_4c, 0.3249*q_12s*q_5s + 0.3249*q_12c*q_5c, 0.31768*q_12s*q_6s + 0.31768*q_12c*q_6c, 0.31046*q_12s*q_7s + 0.31046*q_12c*q_7c, 0.30324*q_12s*q_8s + 0.30324*q_12c*q_8c, 0.29602*q_12s*q_9s + 0.29602*q_12c*q_9c, 0.2888*q_10s*q_12s + 0.2888*q_10c*q_12c, 0.28158*q_1s*q_12s + 0.28158*q_1c*q_12c, 0.2527*q_12s.powi(2) + 0.2527*q_12c.powi(2), 0.185123333333333*q_12s*q_13s + 0.185123333333333*q_12c*q_13c, 0.10488*q_12s*q_14s + 0.10488*q_12c*q_14c, 0.03325*q_12s*q_15s + 0.03325*q_12c*q_15c, 0.243583333333333*q_0s*q_13s + 0.243583333333333*q_0c*q_13c, 0.238711666666667*q_1s*q_13s + 0.238711666666667*q_1c*q_13c, 0.23384*q_13s*q_2s + 0.23384*q_13c*q_2c, 0.228968333333333*q_13s*q_3s + 0.228968333333333*q_13c*q_3c, 0.224096666666667*q_13s*q_4s + 0.224096666666667*q_13c*q_4c, 0.219225*q_13s*q_5s + 0.219225*q_13c*q_5c, 0.214353333333333*q_13s*q_6s + 0.214353333333333*q_13c*q_6c, 0.209481666666667*q_13s*q_7s + 0.209481666666667*q_13c*q_7c, 0.20461*q_13s*q_8s + 0.20461*q_13c*q_8c, 0.199738333333333*q_13s*q_9s + 0.199738333333333*q_13c*q_9c, 0.194866666666667*q_10s*q_13s + 0.194866666666667*q_10c*q_13c, 0.189995*q_1s*q_13s + 0.189995*q_1c*q_13c, 0.185123333333333*q_12s*q_13s + 0.185123333333333*q_12c*q_13c, 0.1608575*q_13s.powi(2) + 0.1608575*q_13c.powi(2), 0.10212*q_13s*q_14s + 0.10212*q_13c*q_14c, 0.032375*q_13s*q_15s + 0.032375*q_13c*q_15c, 0.138*q_0s*q_14s + 0.138*q_0c*q_14c, 0.13524*q_1s*q_14s + 0.13524*q_1c*q_14c, 0.13248*q_14s*q_2s + 0.13248*q_14c*q_2c, 0.12972*q_14s*q_3s + 0.12972*q_14c*q_3c, 0.12696*q_14s*q_4s + 0.12696*q_14c*q_4c, 0.1242*q_14s*q_5s + 0.1242*q_14c*q_5c, 0.12144*q_14s*q_6s + 0.12144*q_14c*q_6c, 0.11868*q_14s*q_7s + 0.11868*q_14c*q_7c, 0.11592*q_14s*q_8s + 0.11592*q_14c*q_8c, 0.11316*q_14s*q_9s + 0.11316*q_14c*q_9c, 0.1104*q_10s*q_14s + 0.1104*q_10c*q_14c, 0.10764*q_1s*q_14s + 0.10764*q_1c*q_14c, 0.10488*q_12s*q_14s + 0.10488*q_12c*q_14c, 0.10212*q_13s*q_14s + 0.10212*q_13c*q_14c, 0.08208*q_14s.powi(2) + 0.08208*q_14c.powi(2), 0.0315*q_14s*q_15s + 0.0315*q_14c*q_15c, 0.04375*q_0s*q_15s + 0.04375*q_0c*q_15c, 0.042875*q_1s*q_15s + 0.042875*q_1c*q_15c, 0.042*q_15s*q_2s + 0.042*q_15c*q_2c, 0.041125*q_15s*q_3s + 0.041125*q_15c*q_3c, 0.04025*q_15s*q_4s + 0.04025*q_15c*q_4c, 0.039375*q_15s*q_5s + 0.039375*q_15c*q_5c, 0.0385*q_15s*q_6s + 0.0385*q_15c*q_6c, 0.037625*q_15s*q_7s + 0.037625*q_15c*q_7c, 0.03675*q_15s*q_8s + 0.03675*q_15c*q_8c, 0.035875*q_15s*q_9s + 0.035875*q_15c*q_9c, 0.035*q_10s*q_15s + 0.035*q_10c*q_15c, 0.034125*q_1s*q_15s + 0.034125*q_1c*q_15c, 0.03325*q_12s*q_15s + 0.03325*q_12c*q_15c, 0.032375*q_13s*q_15s + 0.032375*q_13c*q_15c, 0.0315*q_14s*q_15s + 0.0315*q_14c*q_15c, 0.0153125*q_15s.powi(2) + 0.0153125*q_15c.powi(2)];
    out1
}
fn C_flat(q: [f64; 16], dq: [f64; 16]) ->  [f64; 256] {
    let q_0 = q[0]; let dq_0 = dq[0]; let q_0s = q_0.sin(); let q_0c = q_0.cos(); 
    let q_1 = q[1]; let dq_1 = dq[1]; let q_1s = q_1.sin(); let q_1c = q_1.cos(); 
    let q_2 = q[2]; let dq_2 = dq[2]; let q_2s = q_2.sin(); let q_2c = q_2.cos(); 
    let q_3 = q[3]; let dq_3 = dq[3]; let q_3s = q_3.sin(); let q_3c = q_3.cos(); 
    let q_4 = q[4]; let dq_4 = dq[4]; let q_4s = q_4.sin(); let q_4c = q_4.cos(); 
    let q_5 = q[5]; let dq_5 = dq[5]; let q_5s = q_5.sin(); let q_5c = q_5.cos(); 
    let q_6 = q[6]; let dq_6 = dq[6]; let q_6s = q_6.sin(); let q_6c = q_6.cos(); 
    let q_7 = q[7]; let dq_7 = dq[7]; let q_7s = q_7.sin(); let q_7c = q_7.cos(); 
    let q_8 = q[8]; let dq_8 = dq[8]; let q_8s = q_8.sin(); let q_8c = q_8.cos(); 
    let q_9 = q[9]; let dq_9 = dq[9]; let q_9s = q_9.sin(); let q_9c = q_9.cos(); 
    let q_10 = q[10]; let dq_10 = dq[10]; let q_10s = q_10.sin(); let q_10c = q_10.cos(); 
    let q_11 = q[11]; let dq_11 = dq[11]; let q_11s = q_11.sin(); let q_11c = q_11.cos(); 
    let q_12 = q[12]; let dq_12 = dq[12]; let q_12s = q_12.sin(); let q_12c = q_12.cos(); 
    let q_13 = q[13]; let dq_13 = dq[13]; let q_13s = q_13.sin(); let q_13c = q_13.cos(); 
    let q_14 = q[14]; let dq_14 = dq[14]; let q_14s = q_14.sin(); let q_14c = q_14.cos(); 
    let q_15 = q[15]; let dq_15 = dq[15]; let q_15s = q_15.sin(); let q_15c = q_15.cos(); 
    let out1 = [0.0 ,2.57658333333333*dq_1*q_0s*q_1c - 2.57658333333333*dq_1*q_1s*q_0c, 2.296*dq_2*q_0s*q_2c - 2.296*dq_2*q_2s*q_0c, 2.03275*dq_3*q_0s*q_3c - 2.03275*dq_3*q_3s*q_0c, 1.78633333333333*dq_4*q_0s*q_4c - 1.78633333333333*dq_4*q_4s*q_0c, 1.55625*dq_5*q_0s*q_5c - 1.55625*dq_5*q_5s*q_0c, 1.342*dq_6*q_0s*q_6c - 1.342*dq_6*q_6s*q_0c, 1.14308333333333*dq_7*q_0s*q_7c - 1.14308333333333*dq_7*q_7s*q_0c, 0.959*dq_8*q_0s*q_8c - 0.959*dq_8*q_8s*q_0c, 0.78925*dq_9*q_0s*q_9c - 0.78925*dq_9*q_9s*q_0c, 0.633333333333333*dq_10*q_0s*q_10c - 0.633333333333333*dq_10*q_10s*q_0c, 0.49075*dq_11*q_0s*q_1c - 0.49075*dq_11*q_1s*q_0c, 0.361*\dot{q}_12*q_0s*q_12c - 0.361*\dot{q}_12*q_12s*q_0c, 0.243583333333333*\dot{q}_13*q_0s*q_13c - 0.243583333333333*\dot{q}_13*q_13s*q_0c, 0.138*\dot{q}_14*q_0s*q_14c - 0.138*\dot{q}_14*q_14s*q_0c, 0.04375*\dot{q}_15*q_0s*q_15c - 0.04375*\dot{q}_15*q_15s*q_0c, -2.57658333333333*dq_0*q_0s*q_1c + 2.57658333333333*dq_0*q_1s*q_0c, 0.0 ,2.25008*dq_2*q_1s*q_2c - 2.25008*dq_2*q_2s*q_1c, 1.992095*dq_3*q_1s*q_3c - 1.992095*dq_3*q_3s*q_1c, 1.75060666666667*dq_4*q_1s*q_4c - 1.75060666666667*dq_4*q_4s*q_1c, 1.525125*dq_5*q_1s*q_5c - 1.525125*dq_5*q_5s*q_1c, 1.31516*dq_6*q_1s*q_6c - 1.31516*dq_6*q_6s*q_1c, 1.12022166666667*dq_7*q_1s*q_7c - 1.12022166666667*dq_7*q_7s*q_1c, 0.93982*dq_8*q_1s*q_8c - 0.93982*dq_8*q_8s*q_1c, 0.773465*dq_9*q_1s*q_9c - 0.773465*dq_9*q_9s*q_1c, 0.620666666666667*dq_10*q_1s*q_10c - 0.620666666666667*dq_10*q_10s*q_1c, 0.0 ,0.35378*\dot{q}_12*q_1s*q_12c - 0.35378*\dot{q}_12*q_12s*q_1c, 0.238711666666667*\dot{q}_13*q_1s*q_13c - 0.238711666666667*\dot{q}_13*q_13s*q_1c, 0.13524*\dot{q}_14*q_1s*q_14c - 0.13524*\dot{q}_14*q_14s*q_1c, 0.042875*\dot{q}_15*q_1s*q_15c - 0.042875*\dot{q}_15*q_15s*q_1c, -2.296*dq_0*q_0s*q_2c + 2.296*dq_0*q_2s*q_0c, -2.25008*dq_1*q_1s*q_2c + 2.25008*dq_1*q_2s*q_1c, 0.0 ,1.95144*dq_3*q_2s*q_3c - 1.95144*dq_3*q_3s*q_2c, 1.71488*dq_4*q_2s*q_4c - 1.71488*dq_4*q_4s*q_2c, 1.494*dq_5*q_2s*q_5c - 1.494*dq_5*q_5s*q_2c, 1.28832*dq_6*q_2s*q_6c - 1.28832*dq_6*q_6s*q_2c, 1.09736*dq_7*q_2s*q_7c - 1.09736*dq_7*q_7s*q_2c, 0.92064*dq_8*q_2s*q_8c - 0.92064*dq_8*q_8s*q_2c, 0.75768*dq_9*q_2s*q_9c - 0.75768*dq_9*q_9s*q_2c, -0.608*dq_10*q_10s*q_2c + 0.608*dq_10*q_2s*q_10c, -0.47112*dq_11*q_1s*q_2c + 0.47112*dq_11*q_2s*q_1c, -0.34656*\dot{q}_12*q_12s*q_2c + 0.34656*\dot{q}_12*q_2s*q_12c, -0.23384*\dot{q}_13*q_13s*q_2c + 0.23384*\dot{q}_13*q_2s*q_13c, -0.13248*\dot{q}_14*q_14s*q_2c + 0.13248*\dot{q}_14*q_2s*q_14c, -0.042*\dot{q}_15*q_15s*q_2c + 0.042*\dot{q}_15*q_2s*q_15c, -2.03275*dq_0*q_0s*q_3c + 2.03275*dq_0*q_3s*q_0c, -1.992095*dq_1*q_1s*q_3c + 1.992095*dq_1*q_3s*q_1c, -1.95144*dq_2*q_2s*q_3c + 1.95144*dq_2*q_3s*q_2c, 0.0 ,1.67915333333333*dq_4*q_3s*q_4c - 1.67915333333333*dq_4*q_4s*q_3c, 1.462875*dq_5*q_3s*q_5c - 1.462875*dq_5*q_5s*q_3c, 1.26148*dq_6*q_3s*q_6c - 1.26148*dq_6*q_6s*q_3c, 1.07449833333333*dq_7*q_3s*q_7c - 1.07449833333333*dq_7*q_7s*q_3c, 0.90146*dq_8*q_3s*q_8c - 0.90146*dq_8*q_8s*q_3c, 0.741895*dq_9*q_3s*q_9c - 0.741895*dq_9*q_9s*q_3c, -0.595333333333333*dq_10*q_10s*q_3c + 0.595333333333333*dq_10*q_3s*q_10c, -0.461305*dq_11*q_1s*q_3c + 0.461305*dq_11*q_3s*q_1c, -0.33934*\dot{q}_12*q_12s*q_3c + 0.33934*\dot{q}_12*q_3s*q_12c, -0.228968333333333*\dot{q}_13*q_13s*q_3c + 0.228968333333333*\dot{q}_13*q_3s*q_13c, -0.12972*\dot{q}_14*q_14s*q_3c + 0.12972*\dot{q}_14*q_3s*q_14c, -0.041125*\dot{q}_15*q_15s*q_3c + 0.041125*\dot{q}_15*q_3s*q_15c, -1.78633333333333*dq_0*q_0s*q_4c + 1.78633333333333*dq_0*q_4s*q_0c, -1.75060666666667*dq_1*q_1s*q_4c + 1.75060666666667*dq_1*q_4s*q_1c, -1.71488*dq_2*q_2s*q_4c + 1.71488*dq_2*q_4s*q_2c, -1.67915333333333*dq_3*q_3s*q_4c + 1.67915333333333*dq_3*q_4s*q_3c, 0.0 ,1.43175*dq_5*q_4s*q_5c - 1.43175*dq_5*q_5s*q_4c, 1.23464*dq_6*q_4s*q_6c - 1.23464*dq_6*q_6s*q_4c, 1.05163666666667*dq_7*q_4s*q_7c - 1.05163666666667*dq_7*q_7s*q_4c, 0.88228*dq_8*q_4s*q_8c - 0.88228*dq_8*q_8s*q_4c, 0.72611*dq_9*q_4s*q_9c - 0.72611*dq_9*q_9s*q_4c, -0.582666666666667*dq_10*q_10s*q_4c + 0.582666666666667*dq_10*q_4s*q_10c, -0.45149*dq_11*q_1s*q_4c + 0.45149*dq_11*q_4s*q_1c, -0.33212*\dot{q}_12*q_12s*q_4c + 0.33212*\dot{q}_12*q_4s*q_12c, -0.224096666666667*\dot{q}_13*q_13s*q_4c + 0.224096666666667*\dot{q}_13*q_4s*q_13c, -0.12696*\dot{q}_14*q_14s*q_4c + 0.12696*\dot{q}_14*q_4s*q_14c, -0.04025*\dot{q}_15*q_15s*q_4c + 0.04025*\dot{q}_15*q_4s*q_15c, -1.55625*dq_0*q_0s*q_5c + 1.55625*dq_0*q_5s*q_0c, -1.525125*dq_1*q_1s*q_5c + 1.525125*dq_1*q_5s*q_1c, -1.494*dq_2*q_2s*q_5c + 1.494*dq_2*q_5s*q_2c, -1.462875*dq_3*q_3s*q_5c + 1.462875*dq_3*q_5s*q_3c, -1.43175*dq_4*q_4s*q_5c + 1.43175*dq_4*q_5s*q_4c, 0.0 ,1.2078*dq_6*q_5s*q_6c - 1.2078*dq_6*q_6s*q_5c, 1.028775*dq_7*q_5s*q_7c - 1.028775*dq_7*q_7s*q_5c, 0.8631*dq_8*q_5s*q_8c - 0.8631*dq_8*q_8s*q_5c, 0.710325*dq_9*q_5s*q_9c - 0.710325*dq_9*q_9s*q_5c, -0.57*dq_10*q_10s*q_5c + 0.57*dq_10*q_5s*q_10c, -0.441675*dq_11*q_1s*q_5c + 0.441675*dq_11*q_5s*q_1c, -0.3249*\dot{q}_12*q_12s*q_5c + 0.3249*\dot{q}_12*q_5s*q_12c, -0.219225*\dot{q}_13*q_13s*q_5c + 0.219225*\dot{q}_13*q_5s*q_13c, -0.1242*\dot{q}_14*q_14s*q_5c + 0.1242*\dot{q}_14*q_5s*q_14c, -0.039375*\dot{q}_15*q_15s*q_5c + 0.039375*\dot{q}_15*q_5s*q_15c, -1.342*dq_0*q_0s*q_6c + 1.342*dq_0*q_6s*q_0c, -1.31516*dq_1*q_1s*q_6c + 1.31516*dq_1*q_6s*q_1c, -1.28832*dq_2*q_2s*q_6c + 1.28832*dq_2*q_6s*q_2c, -1.26148*dq_3*q_3s*q_6c + 1.26148*dq_3*q_6s*q_3c, -1.23464*dq_4*q_4s*q_6c + 1.23464*dq_4*q_6s*q_4c, -1.2078*dq_5*q_5s*q_6c + 1.2078*dq_5*q_6s*q_5c, 0.0 ,1.00591333333333*dq_7*q_6s*q_7c - 1.00591333333333*dq_7*q_7s*q_6c, 0.84392*dq_8*q_6s*q_8c - 0.84392*dq_8*q_8s*q_6c, 0.69454*dq_9*q_6s*q_9c - 0.69454*dq_9*q_9s*q_6c, -0.557333333333333*dq_10*q_10s*q_6c + 0.557333333333333*dq_10*q_6s*q_10c, -0.43186*dq_11*q_1s*q_6c + 0.43186*dq_11*q_6s*q_1c, -0.31768*\dot{q}_12*q_12s*q_6c + 0.31768*\dot{q}_12*q_6s*q_12c, -0.214353333333333*\dot{q}_13*q_13s*q_6c + 0.214353333333333*\dot{q}_13*q_6s*q_13c, -0.12144*\dot{q}_14*q_14s*q_6c + 0.12144*\dot{q}_14*q_6s*q_14c, -0.0385*\dot{q}_15*q_15s*q_6c + 0.0385*\dot{q}_15*q_6s*q_15c, -1.14308333333333*dq_0*q_0s*q_7c + 1.14308333333333*dq_0*q_7s*q_0c, -1.12022166666667*dq_1*q_1s*q_7c + 1.12022166666667*dq_1*q_7s*q_1c, -1.09736*dq_2*q_2s*q_7c + 1.09736*dq_2*q_7s*q_2c, -1.07449833333333*dq_3*q_3s*q_7c + 1.07449833333333*dq_3*q_7s*q_3c, -1.05163666666667*dq_4*q_4s*q_7c + 1.05163666666667*dq_4*q_7s*q_4c, -1.028775*dq_5*q_5s*q_7c + 1.028775*dq_5*q_7s*q_5c, -1.00591333333333*dq_6*q_6s*q_7c + 1.00591333333333*dq_6*q_7s*q_6c, 0.0 ,0.82474*dq_8*q_7s*q_8c - 0.82474*dq_8*q_8s*q_7c, 0.678755*dq_9*q_7s*q_9c - 0.678755*dq_9*q_9s*q_7c, -0.544666666666667*dq_10*q_10s*q_7c + 0.544666666666667*dq_10*q_7s*q_10c, -0.422045*dq_11*q_1s*q_7c + 0.422045*dq_11*q_7s*q_1c, -0.31046*\dot{q}_12*q_12s*q_7c + 0.31046*\dot{q}_12*q_7s*q_12c, -0.209481666666667*\dot{q}_13*q_13s*q_7c + 0.209481666666667*\dot{q}_13*q_7s*q_13c, -0.11868*\dot{q}_14*q_14s*q_7c + 0.11868*\dot{q}_14*q_7s*q_14c, -0.037625*\dot{q}_15*q_15s*q_7c + 0.037625*\dot{q}_15*q_7s*q_15c, -0.959*dq_0*q_0s*q_8c + 0.959*dq_0*q_8s*q_0c, -0.93982*dq_1*q_1s*q_8c + 0.93982*dq_1*q_8s*q_1c, -0.92064*dq_2*q_2s*q_8c + 0.92064*dq_2*q_8s*q_2c, -0.90146*dq_3*q_3s*q_8c + 0.90146*dq_3*q_8s*q_3c, -0.88228*dq_4*q_4s*q_8c + 0.88228*dq_4*q_8s*q_4c, -0.8631*dq_5*q_5s*q_8c + 0.8631*dq_5*q_8s*q_5c, -0.84392*dq_6*q_6s*q_8c + 0.84392*dq_6*q_8s*q_6c, -0.82474*dq_7*q_7s*q_8c + 0.82474*dq_7*q_8s*q_7c, 0.0 ,0.66297*dq_9*q_8s*q_9c - 0.66297*dq_9*q_9s*q_8c, -0.532*dq_10*q_10s*q_8c + 0.532*dq_10*q_8s*q_10c, -0.41223*dq_11*q_1s*q_8c + 0.41223*dq_11*q_8s*q_1c, -0.30324*\dot{q}_12*q_12s*q_8c + 0.30324*\dot{q}_12*q_8s*q_12c, -0.20461*\dot{q}_13*q_13s*q_8c + 0.20461*\dot{q}_13*q_8s*q_13c, -0.11592*\dot{q}_14*q_14s*q_8c + 0.11592*\dot{q}_14*q_8s*q_14c, -0.03675*\dot{q}_15*q_15s*q_8c + 0.03675*\dot{q}_15*q_8s*q_15c, -0.78925*dq_0*q_0s*q_9c + 0.78925*dq_0*q_9s*q_0c, -0.773465*dq_1*q_1s*q_9c + 0.773465*dq_1*q_9s*q_1c, -0.75768*dq_2*q_2s*q_9c + 0.75768*dq_2*q_9s*q_2c, -0.741895*dq_3*q_3s*q_9c + 0.741895*dq_3*q_9s*q_3c, -0.72611*dq_4*q_4s*q_9c + 0.72611*dq_4*q_9s*q_4c, -0.710325*dq_5*q_5s*q_9c + 0.710325*dq_5*q_9s*q_5c, -0.69454*dq_6*q_6s*q_9c + 0.69454*dq_6*q_9s*q_6c, -0.678755*dq_7*q_7s*q_9c + 0.678755*dq_7*q_9s*q_7c, -0.66297*dq_8*q_8s*q_9c + 0.66297*dq_8*q_9s*q_8c, 0.0 ,-0.519333333333333*dq_10*q_10s*q_9c + 0.519333333333333*dq_10*q_9s*q_10c, -0.402415*dq_11*q_1s*q_9c + 0.402415*dq_11*q_9s*q_1c, -0.29602*\dot{q}_12*q_12s*q_9c + 0.29602*\dot{q}_12*q_9s*q_12c, -0.199738333333333*\dot{q}_13*q_13s*q_9c + 0.199738333333333*\dot{q}_13*q_9s*q_13c, -0.11316*\dot{q}_14*q_14s*q_9c + 0.11316*\dot{q}_14*q_9s*q_14c, -0.035875*\dot{q}_15*q_15s*q_9c + 0.035875*\dot{q}_15*q_9s*q_15c, -0.633333333333333*dq_0*q_0s*q_10c + 0.633333333333333*dq_0*q_10s*q_0c, -0.620666666666667*dq_1*q_1s*q_10c + 0.620666666666667*dq_1*q_10s*q_1c, 0.608*dq_2*q_10s*q_2c - 0.608*dq_2*q_2s*q_10c, 0.595333333333333*dq_3*q_10s*q_3c - 0.595333333333333*dq_3*q_3s*q_10c, 0.582666666666667*dq_4*q_10s*q_4c - 0.582666666666667*dq_4*q_4s*q_10c, 0.57*dq_5*q_10s*q_5c - 0.57*dq_5*q_5s*q_10c, 0.557333333333333*dq_6*q_10s*q_6c - 0.557333333333333*dq_6*q_6s*q_10c, 0.544666666666667*dq_7*q_10s*q_7c - 0.544666666666667*dq_7*q_7s*q_10c, 0.532*dq_8*q_10s*q_8c - 0.532*dq_8*q_8s*q_10c, 0.519333333333333*dq_9*q_10s*q_9c - 0.519333333333333*dq_9*q_9s*q_10c, 0.0 ,-0.3926*dq_11*q_1s*q_10c + 0.3926*dq_11*q_10s*q_1c, 0.2888*\dot{q}_12*q_10s*q_12c - 0.2888*\dot{q}_12*q_12s*q_10c, 0.194866666666667*\dot{q}_13*q_10s*q_13c - 0.194866666666667*\dot{q}_13*q_13s*q_10c, 0.1104*\dot{q}_14*q_10s*q_14c - 0.1104*\dot{q}_14*q_14s*q_10c, 0.035*\dot{q}_15*q_10s*q_15c - 0.035*\dot{q}_15*q_15s*q_10c, -0.49075*dq_0*q_0s*q_1c + 0.49075*dq_0*q_1s*q_0c, 0.0 ,0.47112*dq_2*q_1s*q_2c - 0.47112*dq_2*q_2s*q_1c, 0.461305*dq_3*q_1s*q_3c - 0.461305*dq_3*q_3s*q_1c, 0.45149*dq_4*q_1s*q_4c - 0.45149*dq_4*q_4s*q_1c, 0.441675*dq_5*q_1s*q_5c - 0.441675*dq_5*q_5s*q_1c, 0.43186*dq_6*q_1s*q_6c - 0.43186*dq_6*q_6s*q_1c, 0.422045*dq_7*q_1s*q_7c - 0.422045*dq_7*q_7s*q_1c, 0.41223*dq_8*q_1s*q_8c - 0.41223*dq_8*q_8s*q_1c, 0.402415*dq_9*q_1s*q_9c - 0.402415*dq_9*q_9s*q_1c, 0.3926*dq_10*q_1s*q_10c - 0.3926*dq_10*q_10s*q_1c, 0.0 ,0.28158*\dot{q}_12*q_1s*q_12c - 0.28158*\dot{q}_12*q_12s*q_1c, 0.189995*\dot{q}_13*q_1s*q_13c - 0.189995*\dot{q}_13*q_13s*q_1c, 0.10764*\dot{q}_14*q_1s*q_14c - 0.10764*\dot{q}_14*q_14s*q_1c, 0.034125*\dot{q}_15*q_1s*q_15c - 0.034125*\dot{q}_15*q_15s*q_1c, -0.361*dq_0*q_0s*q_12c + 0.361*dq_0*q_12s*q_0c, -0.35378*dq_1*q_1s*q_12c + 0.35378*dq_1*q_12s*q_1c, 0.34656*dq_2*q_12s*q_2c - 0.34656*dq_2*q_2s*q_12c, 0.33934*dq_3*q_12s*q_3c - 0.33934*dq_3*q_3s*q_12c, 0.33212*dq_4*q_12s*q_4c - 0.33212*dq_4*q_4s*q_12c, 0.3249*dq_5*q_12s*q_5c - 0.3249*dq_5*q_5s*q_12c, 0.31768*dq_6*q_12s*q_6c - 0.31768*dq_6*q_6s*q_12c, 0.31046*dq_7*q_12s*q_7c - 0.31046*dq_7*q_7s*q_12c, 0.30324*dq_8*q_12s*q_8c - 0.30324*dq_8*q_8s*q_12c, 0.29602*dq_9*q_12s*q_9c - 0.29602*dq_9*q_9s*q_12c, -0.2888*dq_10*q_10s*q_12c + 0.2888*dq_10*q_12s*q_10c, -0.28158*dq_11*q_1s*q_12c + 0.28158*dq_11*q_12s*q_1c, 0.0 ,0.185123333333333*\dot{q}_13*q_12s*q_13c - 0.185123333333333*\dot{q}_13*q_13s*q_12c, 0.10488*\dot{q}_14*q_12s*q_14c - 0.10488*\dot{q}_14*q_14s*q_12c, 0.03325*\dot{q}_15*q_12s*q_15c - 0.03325*\dot{q}_15*q_15s*q_12c, -0.243583333333333*dq_0*q_0s*q_13c + 0.243583333333333*dq_0*q_13s*q_0c, -0.238711666666667*dq_1*q_1s*q_13c + 0.238711666666667*dq_1*q_13s*q_1c, 0.23384*dq_2*q_13s*q_2c - 0.23384*dq_2*q_2s*q_13c, 0.228968333333333*dq_3*q_13s*q_3c - 0.228968333333333*dq_3*q_3s*q_13c, 0.224096666666667*dq_4*q_13s*q_4c - 0.224096666666667*dq_4*q_4s*q_13c, 0.219225*dq_5*q_13s*q_5c - 0.219225*dq_5*q_5s*q_13c, 0.214353333333333*dq_6*q_13s*q_6c - 0.214353333333333*dq_6*q_6s*q_13c, 0.209481666666667*dq_7*q_13s*q_7c - 0.209481666666667*dq_7*q_7s*q_13c, 0.20461*dq_8*q_13s*q_8c - 0.20461*dq_8*q_8s*q_13c, 0.199738333333333*dq_9*q_13s*q_9c - 0.199738333333333*dq_9*q_9s*q_13c, -0.194866666666667*dq_10*q_10s*q_13c + 0.194866666666667*dq_10*q_13s*q_10c, -0.189995*dq_11*q_1s*q_13c + 0.189995*dq_11*q_13s*q_1c, -0.185123333333333*\dot{q}_12*q_12s*q_13c + 0.185123333333333*\dot{q}_12*q_13s*q_12c, 0.0 ,0.10212*\dot{q}_14*q_13s*q_14c - 0.10212*\dot{q}_14*q_14s*q_13c, 0.032375*\dot{q}_15*q_13s*q_15c - 0.032375*\dot{q}_15*q_15s*q_13c, -0.138*dq_0*q_0s*q_14c + 0.138*dq_0*q_14s*q_0c, -0.13524*dq_1*q_1s*q_14c + 0.13524*dq_1*q_14s*q_1c, 0.13248*dq_2*q_14s*q_2c - 0.13248*dq_2*q_2s*q_14c, 0.12972*dq_3*q_14s*q_3c - 0.12972*dq_3*q_3s*q_14c, 0.12696*dq_4*q_14s*q_4c - 0.12696*dq_4*q_4s*q_14c, 0.1242*dq_5*q_14s*q_5c - 0.1242*dq_5*q_5s*q_14c, 0.12144*dq_6*q_14s*q_6c - 0.12144*dq_6*q_6s*q_14c, 0.11868*dq_7*q_14s*q_7c - 0.11868*dq_7*q_7s*q_14c, 0.11592*dq_8*q_14s*q_8c - 0.11592*dq_8*q_8s*q_14c, 0.11316*dq_9*q_14s*q_9c - 0.11316*dq_9*q_9s*q_14c, -0.1104*dq_10*q_10s*q_14c + 0.1104*dq_10*q_14s*q_10c, -0.10764*dq_11*q_1s*q_14c + 0.10764*dq_11*q_14s*q_1c, -0.10488*\dot{q}_12*q_12s*q_14c + 0.10488*\dot{q}_12*q_14s*q_12c, -0.10212*\dot{q}_13*q_13s*q_14c + 0.10212*\dot{q}_13*q_14s*q_13c, 0.0 ,0.0315*\dot{q}_15*q_14s*q_15c - 0.0315*\dot{q}_15*q_15s*q_14c, -0.04375*dq_0*q_0s*q_15c + 0.04375*dq_0*q_15s*q_0c, -0.042875*dq_1*q_1s*q_15c + 0.042875*dq_1*q_15s*q_1c, 0.042*dq_2*q_15s*q_2c - 0.042*dq_2*q_2s*q_15c, 0.041125*dq_3*q_15s*q_3c - 0.041125*dq_3*q_3s*q_15c, 0.04025*dq_4*q_15s*q_4c - 0.04025*dq_4*q_4s*q_15c, 0.039375*dq_5*q_15s*q_5c - 0.039375*dq_5*q_5s*q_15c, 0.0385*dq_6*q_15s*q_6c - 0.0385*dq_6*q_6s*q_15c, 0.037625*dq_7*q_15s*q_7c - 0.037625*dq_7*q_7s*q_15c, 0.03675*dq_8*q_15s*q_8c - 0.03675*dq_8*q_8s*q_15c, 0.035875*dq_9*q_15s*q_9c - 0.035875*dq_9*q_9s*q_15c, -0.035*dq_10*q_10s*q_15c + 0.035*dq_10*q_15s*q_10c, -0.034125*dq_11*q_1s*q_15c + 0.034125*dq_11*q_15s*q_1c, -0.03325*\dot{q}_12*q_12s*q_15c + 0.03325*\dot{q}_12*q_15s*q_12c, -0.032375*\dot{q}_13*q_13s*q_15c + 0.032375*\dot{q}_13*q_15s*q_13c, -0.0315*\dot{q}_14*q_14s*q_15c + 0.0315*\dot{q}_14*q_15s*q_14c, 0.0];
    out1
}
fn D_flat() -> [f64; 256] {
    let out1 = [0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.01, -0.005, 0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,0.0 ,-0.005, 0.005];
    out1
}
fn g_flat(q: [f64; 16]) ->  [f64; 16] {
    let q_0 = q[0]; let q_0s = q_0.sin(); let q_0c = q_0.cos(); 
    let q_1 = q[1]; let q_1s = q_1.sin(); let q_1c = q_1.cos(); 
    let q_2 = q[2]; let q_2s = q_2.sin(); let q_2c = q_2.cos(); 
    let q_3 = q[3]; let q_3s = q_3.sin(); let q_3c = q_3.cos(); 
    let q_4 = q[4]; let q_4s = q_4.sin(); let q_4c = q_4.cos(); 
    let q_5 = q[5]; let q_5s = q_5.sin(); let q_5c = q_5.cos(); 
    let q_6 = q[6]; let q_6s = q_6.sin(); let q_6c = q_6.cos(); 
    let q_7 = q[7]; let q_7s = q_7.sin(); let q_7c = q_7.cos(); 
    let q_8 = q[8]; let q_8s = q_8.sin(); let q_8c = q_8.cos(); 
    let q_9 = q[9]; let q_9s = q_9.sin(); let q_9c = q_9.cos(); 
    let q_10 = q[10]; let q_10s = q_10.sin(); let q_10c = q_10.cos(); 
    let q_11 = q[11]; let q_11s = q_11.sin(); let q_11c = q_11.cos(); 
    let q_12 = q[12]; let q_12s = q_12.sin(); let q_12c = q_12.cos(); 
    let q_13 = q[13]; let q_13s = q_13.sin(); let q_13c = q_13.cos(); 
    let q_14 = q[14]; let q_14s = q_14.sin(); let q_14c = q_14.cos(); 
    let q_15 = q[15]; let q_15s = q_15.sin(); let q_15c = q_15.cos(); 
    let out1 = [-56.4075*q_0s, -50.552565*q_1s, -45.04752*q_2s, -39.882555*q_3s, -35.04786*q_4s, -30.533625*q_5s, -26.33004*q_6s, -22.427295*q_7s, -18.81558*q_8s, -15.485085*q_9s, -12.426*q_10s, -9.628515*q_1s, -7.08282*q_12s, -4.779105*q_13s, -2.70756*q_14s, -0.858375*q_15s];
    out1
}

pub fn robotic_system(t:f64, x:Array1::<f64>) -> Array1::<f64> {
let mut q_vec = [0.0; DOF];
let mut dq_vec = [0.0; DOF];
for idx in 0..DOF {
q_vec[idx] = x[idx];
dq_vec[idx] = x[idx+DOF];
}
let q:Array1::<f64> = Array::from_vec(q_vec.to_vec());
let dq:Array1::<f64> = Array::from_vec(dq_vec.to_vec());
let N:usize = q.dim();
let dq_:Array1::<f64> = dq.clone();
let M: Array2::<f64> = Array::from_shape_vec((N,N), M_flat(q_vec).to_vec()).unwrap();
let C: Array2::<f64> = Array::from_shape_vec((N,N), C_flat(q_vec, dq_vec).to_vec()).unwrap();
let D: Array2::<f64> = Array::from_shape_vec((N,N), D_flat().to_vec()).unwrap();
let g: Array1::<f64> = Array::from_vec(g_flat(q_vec).to_vec());
let ddq_:Array1::<f64> = M.solve_into(-C.dot(&dq) - D.dot(&dq) - g).unwrap();
return concatenate(Axis(0), &[dq_.view(), ddq_.view()]).unwrap();
}